<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>William Chang // Astrophysics</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700&family=Roboto:wght@300;400;700&family=Share+Tech+Mono&display=swap" rel="stylesheet">
    <style>
        :root {
            --background-color: #010010;
            --container-bg: rgba(10, 15, 30, 0.85);
            --main-text-color: #e0e0e0;
            --header-color: #ffffff;
            --accent-color-1: #6c8cff;
            --accent-color-2: #a87ffb;
            --border-color: rgba(108, 140, 255, 0.4);
            --border-glow-color: rgba(108, 140, 255, 0.6);
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        body {
            background-color: var(--background-color);
            color: var(--main-text-color);
            font-family: 'Roboto', sans-serif;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            overflow: hidden;
            position: relative;
            cursor: auto;
        }
        
        #starfield, #fast-particles {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 1;
            pointer-events: none;
        }
        
        #fast-particles {
            z-index: 2;
        }

        /* Cover Page */
        #cover-page {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 200;
            text-align: center;
            color: white;
            transition: opacity 1s ease-out 0.5s;
        }
        
        #cover-canvas {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -1;
            cursor: grab;
        }

        #cover-canvas:active {
            cursor: grabbing;
        }

        #cover-page h1, #cover-page h2, #cover-page button {
            position: relative;
            z-index: 1;
            opacity: 0;
            transform: translateY(20px);
            transition: opacity 0.8s ease-out, transform 0.8s ease-out;
        }
        
        #cover-page.loaded h1 { opacity: 1; transform: translateY(0); transition-delay: 0.5s; }
        #cover-page.loaded h2 { opacity: 1; transform: translateY(0); transition-delay: 1.3s; }
        #cover-page.loaded button { opacity: 1; transform: translateY(0); transition-delay: 2.1s; }


        #cover-page h1 {
            font-family: 'Orbitron', sans-serif;
            font-size: 4rem;
            text-shadow: 0 0 15px rgba(255, 255, 255, 0.7);
        }

        #cover-page h2 {
            font-family: 'Orbitron', sans-serif;
            font-weight: 300;
            font-size: 1.5rem;
            margin-top: 10px;
            margin-bottom: 40px;
            animation: tracking-in-expand 1s cubic-bezier(0.215, 0.610, 0.355, 1.000) both;
        }

        @keyframes tracking-in-expand {
          0% { letter-spacing: -0.5em; opacity: 0; }
          40% { opacity: 0.6; }
          100% { opacity: 1; }
        }

        #enter-button {
            font-family: 'Orbitron', sans-serif;
            background: transparent;
            border: 2px solid white;
            color: white;
            padding: 15px 30px;
            font-size: 1.2rem;
            cursor: pointer;
            transition: all 0.3s ease;
            animation: pulse-glow 3s infinite ease-in-out;
        }
        
        @keyframes pulse-glow {
            0%, 100% { box-shadow: 0 0 15px rgba(255, 255, 255, 0.3); }
            50% { box-shadow: 0 0 25px rgba(255, 255, 255, 0.7); }
        }

        #enter-button:hover {
            background: rgba(255, 255, 255, 0.2);
            animation-play-state: paused;
        }

        .container {
            width: 95%;
            max-width: 1400px;
            height: 90vh;
            padding: 30px;
            overflow-y: auto;
            position: relative;
            z-index: 100;
            background: var(--container-bg);
            backdrop-filter: blur(5px);
            display: none;
            flex-direction: column;
            opacity: 0;
            transition: opacity 1s ease-in;
            border: 1px solid var(--border-color);
            box-shadow: 0 0 25px var(--border-glow-color);
        }

        .container::-webkit-scrollbar { width: 10px; }
        .container::-webkit-scrollbar-track { background: var(--background-color); }
        .container::-webkit-scrollbar-thumb { background-color: var(--accent-color-1); border-radius: 5px; border: 2px solid var(--background-color); }

        header {
            text-align: center;
            margin-bottom: 25px;
            border-bottom: 1px solid var(--border-color);
            padding-bottom: 20px;
        }

        header h1 {
            font-family: 'Orbitron', sans-serif;
            font-size: 2.5em;
            color: var(--header-color);
            margin-bottom: 5px;
            animation: text-flicker 4s linear infinite;
        }
        
        @keyframes text-flicker {
            0%, 18%, 22%, 25%, 53%, 57%, 100% { text-shadow: 0 0 4px #fff, 0 0 11px #fff, 0 0 19px #fff, 0 0 40px var(--accent-color-1), 0 0 80px var(--accent-color-1); }
            20%, 24%, 55% { text-shadow: none; }
        }

        header h2 { 
            font-family: 'Orbitron', sans-serif;
            font-size: 1.2em; 
            color: var(--accent-color-2); 
            font-weight: 400; 
            animation: focus-in 1.2s cubic-bezier(0.550, 0.085, 0.680, 0.530) both;
        }
        
        @keyframes focus-in {
          0% { filter: blur(12px); opacity: 0; }
          100% { filter: blur(0px); opacity: 1; }
        }

        nav { text-align: center; margin-bottom: 30px; }

        nav a {
            font-family: 'Orbitron', sans-serif;
            color: var(--main-text-color);
            text-decoration: none;
            margin: 0 12px;
            font-size: 1em;
            padding: 8px 12px;
            position: relative;
            transition: all 0.3s ease;
            cursor: pointer;
        }

        nav a::after { content: ''; position: absolute; bottom: 0; left: 50%; transform: translateX(-50%); width: 0; height: 2px; background-color: var(--accent-color-2); transition: width 0.3s ease; }
        nav a:hover::after, nav a.active::after { width: 100%; }
        nav a:hover, nav a.active { color: var(--header-color); text-shadow: 0 0 8px var(--accent-color-2); }

        main { flex-grow: 1; }

        .content-section { display: none; }
        .content-section.active { display: block; }

        .content-section h3 {
            font-family: 'Orbitron', sans-serif;
            color: var(--accent-color-1);
            margin-bottom: 20px;
            font-size: 1.6em;
            border-bottom: 1px solid var(--border-color);
            padding-bottom: 10px;
            display: inline-block;
        }
        
        .content-section.active h3 {
            animation: typing-reveal 1s steps(30) forwards;
        }
        
        @keyframes typing-reveal {
            from { clip-path: inset(0 100% 0 0); }
            to { clip-path: inset(0 0 0 0); }
        }
        
        .content-section h4 {
            font-family: 'Orbitron', sans-serif;
            color: var(--accent-color-2);
            margin-top: 25px;
            margin-bottom: 15px;
            font-size: 1.2em;
            position: relative;
        }

        .content-section.active h4 {
            animation: glitch 1s linear forwards;
        }

        @keyframes glitch{
          0%, 20%, 24%, 60%, 64%, 100% { transform: none; opacity: 1; }
          22% { transform: skew(-0.5deg, -0.9deg); opacity: 0.75; }
          62% { transform: skew(0.8deg, 0.2deg); opacity: 0.5; }
        }
        
        .about-container { display: flex; gap: 20px; align-items: flex-start; }
        .about-text { flex: 3; }
        .profile-pic-container { flex: 1; min-width: 150px; }

        .profile-pic {
            width: 100%;
            padding-top: 100%;
            border-radius: 50%;
            border: 2px solid var(--accent-color-1);
            box-shadow: 0 0 20px var(--border-glow-color);
            background-image: url('https://images.unsplash.com/photo-1545156521-8be1b29d4342?q=80&w=1974&auto=format&fit=crop');
            background-size: cover;
            background-position: center;
        }

        .content-section p, .content-section ul {
            font-family: 'Share Tech Mono', monospace;
            line-height: 1.7;
            margin-bottom: 15px;
        }

        .content-section ul { list-style-type: none; padding-left: 5px; }
        .content-section ul li { padding-left: 25px; position: relative; margin-bottom: 8px; transition: all 0.2s ease; }
        .content-section ul li:hover { color: var(--header-color); transform: translateX(5px); }

        .content-section ul li::before {
            content: '';
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='12' viewBox='0 0 24 24' fill='none' stroke='%236c8cff' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpath d='M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z'/%3E%3C/svg%3E");
            background-repeat: no-repeat;
            background-size: contain;
            width: 12px;
            height: 12px;
            position: absolute;
            left: 0;
            top: 6px;
            transition: all 0.2s ease;
        }
        .content-section ul li:hover::before { filter: drop-shadow(0 0 5px var(--header-color)); transform: rotate(360deg); }
        
        .content-section a { color: var(--accent-color-2); text-decoration: none; font-weight: 400; transition: color 0.3s; cursor: pointer; }
        .content-section a:hover { color: var(--header-color); text-decoration: underline; }

        .animated-item {
            opacity: 0;
            animation: fade-in-up 0.5s ease-out forwards;
        }

        @keyframes fade-in-up {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        /* Research Log Grid */
        .research-split-screen {
            display: flex;
            height: 70vh; /* Give it a fixed height */
            width: 100%;
            gap: 5px;
        }
        .research-panel {
            flex: 1;
            position: relative;
            background-size: cover;
            background-position: center;
            border-radius: 5px;
            overflow: hidden;
            transition: flex 0.7s cubic-bezier(0.165, 0.84, 0.44, 1);
            cursor: pointer;
        }
        .research-panel:hover {
            flex: 3;
        }
        .research-panel::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(to top, rgba(0,0,0,0.9) 0%, rgba(0,0,0,0) 50%);
            transition: background 0.5s ease;
        }
        .research-panel:hover::before {
            background: linear-gradient(to top, rgba(0,0,0,0.9) 0%, rgba(0,0,0,0.2) 50%);
        }
        .panel-content {
            position: absolute;
            bottom: 20px;
            left: 20px;
            color: white;
            z-index: 2;
            transition: all 0.5s ease;
            transform: translateY(10px);
            opacity: 0;
        }
        .research-panel:hover .panel-content {
            transform: translateY(0);
            opacity: 1;
        }
        .panel-content h5 {
            font-family: 'Orbitron';
            font-size: 1.5em;
            text-shadow: 2px 2px 4px black;
        }
        .panel-content .institution {
            font-family: 'Share Tech Mono';
        }

    </style>
</head>
<body>
    <canvas id="starfield"></canvas>
    <canvas id="fast-particles"></canvas>

    <div id="cover-page">
        <canvas id="cover-canvas"></canvas>
        <h1>WILLIAM CHANG</h1>
        <h2>Computational Cosmology & Particle Astrophysics</h2>
        <button id="enter-button">EXPLORE</button>
    </div>

    <div class="container">
        <header>
            <h1>WILLIAM CHANG</h1>
            <h2>Graduate Research Fellow // Yale University</h2>
        </header>

        <nav>
            <a href="#about" class="nav-link active">About</a>
            <a href="#research" class="nav-link">Research</a>
            <a href="#publications" class="nav-link">Publications</a>
            <a href="#experience" class="nav-link">Experience</a>
            <a href="#teaching" class="nav-link">Teaching</a>
            <a href="#contact" class="nav-link">Contact</a>
        </nav>

        <main>
            <section id="about" class="content-section active">
                <h3>Mission Briefing</h3>
                <div class="about-container">
                    <div class="about-text">
                        <p>
                            Invested in direct/indirect imaging techniques, the evolution of brown dwarfs, and the merging of galaxies, I conduct research that encompasses astrophysics, data science, and engineering. My current research focuses on characterizing exoplanet orbital architecture with microlensing and astrometry. I am competent in solving scientific and engineering problems with machine learning models and optics techniques. I have experience in probing the stochastic gravitational wave background with multi-messenger astrophysics, exploring extrasolar planetary systems and circumstellar disks with spectropolarimetry, and utilizing convolutional neural networks to improve computer vision algorithms.
                        </p>
                    </div>
                    <div class="profile-pic-container">
                        <div class="profile-pic"></div>
                    </div>
                </div>
                 <h4>Skill Matrix</h4>
                 <ul>
                    <li><b>Languages:</b> Mandarin (Native), English (Native), Japanese (Professional), Spanish (Advanced)</li>
                    <li><b>Programming:</b> Python, C, C++, Java, MATLAB, R, Mathematica, AutoCAD, Shell/Linux</li>
                 </ul>
                 <h4>Education History</h4>
                 <ul>
                    <li><b>Ph.D. in Physics</b> - Yale University (2024 - 2029)</li>
                    <li><b>B.S. in Physics; Mathematics Minor</b> - University of California, Los Angeles (2022 - 2024) <br><em>Highest Honors; Cum Laude; College Honors</em></li>
                    <li><b>Major in Physics</b> - University of California, Santa Barbara (2020 - 2022)</li>
                </ul>
            </section>
            
            <section id="research" class="content-section">
                <h3>Research Logs</h3>
                <div class="research-split-screen">
                    <div class="research-panel" style="background-image: url('https://images.unsplash.com/photo-1570314543733-346394c8b93a?q=80&w=2070&auto=format&fit=crop')">
                        <div class="panel-content">
                            <h5>Exoplanet Architectures</h5>
                            <div class="institution">Yale University</div>
                        </div>
                    </div>
                    <div class="research-panel" style="background-image: url('https://github.com/Shou-Bonn/shou-bonn.github.io/blob/main/images/grav_waves.jpg')">
                         <div class="panel-content">
                            <h5>Gravitational Waves</h5>
                            <div class="institution">Yale University</div>
                        </div>
                    </div>
                    <div class="research-panel" style="background-image: url('https://images.unsplash.com/photo-1534447677768-be436a0976f2?q=80&w=2070&auto=format&fit=crop')">
                         <div class="panel-content">
                            <h5>Infrared Instrumentation</h5>
                            <div class="institution">UCLA</div>
                        </div>
                    </div>
                    <div class="research-panel" style="background-image: url('https://images.unsplash.com/photo-1506443432602-ac2fcd6f54e0?q=80&w=1974&auto=format&fit=crop')">
                         <div class="panel-content">
                            <h5>Brown Dwarf Disks</h5>
                            <div class="institution">Caltech</div>
                        </div>
                    </div>
                     <div class="research-panel" style="background-image: url('https://images.unsplash.com/photo-1502134249126-9f3755a50d78?q=80&w=2070&auto=format&fit=crop')">
                         <div class="panel-content">
                            <h5>Exoplanet Polarimetry</h5>
                            <div class="institution">UCSB</div>
                        </div>
                    </div>
                </div>
            </section>
            
            <section id="publications" class="content-section">
                <h3>Published Archives</h3>
                <ul>
                    <li>Millar-Blanchaer M., Nilsson R., Samaporn T., Dimitri M., and et al. <b>Chang, W.</b> The WIRC+Pol Brown Dwarf Survey: A J-band polarimetric survey of 22 brown dwarfs. <em>The Astronomical Journal</em>, 2025; Submitted for publication.</li>
                    <li>Hsia C.-H., <b>Chang, T.-H. W.</b>, Chiang C.-Y., and Chan H.-T. Mask R-CNN with new data augmentation features for smart detection of retail products. <em>Applied Sciences</em>, 12(6), 2022. <a href="https://doi.org/10.3390/app12062902" target="_blank">[Access Data]</a></li>
                    <li>Hsia C.-H., <b>Chang, W.</b>, Chiang C.-Y., and Chan H.-T. Real-time retail product detection with new augmentation features. In <em>2021 International Conference on Electronic Communications, Internet of Things and Big Data (ICEIB)</em>, pages 221-223. IEEE, 12 2021. <a href="https://doi.org/10.1109/ICEIB53692.2021.9686393" target="_blank">[Access Data]</a></li>
                </ul>
            </section>

            <section id="experience" class="content-section">
                <h3>Service Record</h3>
                <h4>Fellowships</h4>
                <ul>
                    <li>McDougal Graduate Teaching Fellow, Yale Poorvu Center for Teaching and Learning (2025 - 2026)</li>
                    <li>SURF Program, Summer Undergraduate Research Fellow, Caltech (2023)</li>
                </ul>
                <h4>Leadership Positions</h4>
                <ul>
                    <li>Core E-Board Secretary, Graduate & Professional Student Senate at Yale (May 2025 - Present)</li>
                    <li>President, Yale Taiwanese Student Association (May 2025 - Present)</li>
                    <li>Head Learning Assistant & Admissions, UCLA Undergraduate Learning Assistant Program (Sep 2023 - Dec 2023)</li>
                    <li>President, UCLA Taiwanese Student Association (Jun 2023 - Jun 2024)</li>
                </ul>
            </section>

            <section id="teaching" class="content-section">
                <h3>Teaching & Outreach</h3>
                <h4>Teaching Appointments</h4>
                <ul>
                    <li><b>Yale University:</b> PHYS 171 & PHYS 378, Teaching Assistant</li>
                    <li><b>UCLA:</b> Grader & Learning Assistant for PHYS 1A, 1B, 1C, 5A, 5C, 5BL</li>
                    <li><b>UCSB:</b> Instructional Assistant, Grader, & Tutor for INT 84AT, INT 84AH, PHYS 100A, PHYS 29</li>
                </ul>
                <h4>Outreach & Advocacy</h4>
                 <ul>
                    <li>Yale Capitol Hill Day, Space Policy Delegate</li>
                    <li>Yale Pathways Girls' Science Investigations, Volunteer Staff</li>
                    <li>NASA Eclipse Ambassador Program, Ambassador</li>
                    <li>United States Invitational Young Physicists Tournament, Juror</li>
                    <li>Sigma Xi International Forum of Research Excellence, Judge</li>
                    <li>Santa Barbara Museum of Natural History, Telescope Technician</li>
                </ul>
            </section>

            <section id="contact" class="content-section">
                <h3>Contact & Comms</h3>
                <ul>
                    <li>Email: <a href="mailto:william.chang@yale.edu">william.chang@yale.edu</a></li>
                    <li>LinkedIn: <a href="https://www.linkedin.com/in/williamchang0414/" target="_blank">linkedin.com/in/williamchang0414</a></li>
                    <li>GitHub: <a href="#" target="_blank">github.com/your-username</a> <!-- EDIT THIS --></li>
                </ul>
            </section>
        </main>
    </div>

    <script>
        // --- DragControls for Three.js ---
        const DragControls = function (_objects, _camera, _domElement) {
            const _plane = new THREE.Plane();
            const _raycaster = new THREE.Raycaster();
            const _mouse = new THREE.Vector2();
            const _offset = new THREE.Vector3();
            const _intersection = new THREE.Vector3();
            const _worldPosition = new THREE.Vector3();
            let _intersections = [];
            let _selected = null, _hovered = null;

            const scope = this;
            function activate() {
                _domElement.addEventListener('mousemove', onDocumentMouseMove, false);
                _domElement.addEventListener('mousedown', onDocumentMouseDown, false);
                _domElement.addEventListener('mouseup', onDocumentMouseUp, false);
            }
            function deactivate() {
                _domElement.removeEventListener('mousemove', onDocumentMouseMove, false);
                _domElement.removeEventListener('mousedown', onDocumentMouseDown, false);
                _domElement.removeEventListener('mouseup', onDocumentMouseUp, false);
            }
            function dispose() { deactivate(); }

            function onDocumentMouseMove(event) {
                event.preventDefault();
                const rect = _domElement.getBoundingClientRect();
                _mouse.x = ((event.clientX - rect.left) / rect.width) * 2 - 1;
                _mouse.y = -((event.clientY - rect.top) / rect.height) * 2 + 1;
                _raycaster.setFromCamera(_mouse, _camera);

                if (_selected) {
                    if (_raycaster.ray.intersectPlane(_plane, _intersection)) {
                        _selected.position.copy(_intersection.sub(_offset));
                    }
                    scope.dispatchEvent({ type: 'drag', object: _selected });
                    return;
                }
                _intersections.length = 0;
                _raycaster.intersectObjects(_objects, true, _intersections);
                if (_intersections.length > 0) {
                    const object = _intersections[0].object;
                    _plane.setFromNormalAndCoplanarPoint(_camera.getWorldDirection(_plane.normal), _worldPosition.setFromMatrixPosition(object.matrixWorld));
                    if (_hovered !== object) {
                        scope.dispatchEvent({ type: 'hoveron', object: object });
                        _domElement.style.cursor = 'pointer';
                        _hovered = object;
                    }
                } else {
                    if (_hovered !== null) {
                        scope.dispatchEvent({ type: 'hoveroff', object: _hovered });
                        _domElement.style.cursor = 'grab';
                        _hovered = null;
                    }
                }
            }

            function onDocumentMouseDown(event) {
                event.preventDefault();
                _raycaster.setFromCamera(_mouse, _camera);
                _intersections.length = 0;
                _raycaster.intersectObjects(_objects, true, _intersections);
                if (_intersections.length > 0) {
                    _selected = _intersections[0].object;
                    if (_raycaster.ray.intersectPlane(_plane, _intersection)) {
                         _offset.copy(_intersection).sub(_worldPosition.setFromMatrixPosition(_selected.matrixWorld));
                    }
                    _domElement.style.cursor = 'grabbing';
                    scope.dispatchEvent({ type: 'dragstart', object: _selected });
                }
            }

            function onDocumentMouseUp(event) {
                event.preventDefault();
                if (_selected) {
                    scope.dispatchEvent({ type: 'dragend', object: _selected });
                    _selected = null;
                }
                _domElement.style.cursor = 'grab';
            }
            activate();
            this.enabled = true;
            this.activate = activate;
            this.deactivate = deactivate;
            this.dispose = dispose;
        };
        DragControls.prototype = Object.create(THREE.EventDispatcher.prototype);
        DragControls.prototype.constructor = DragControls;


        document.addEventListener('DOMContentLoaded', function() {
            const mainContainer = document.querySelector('.container');
            const coverPage = document.getElementById('cover-page');
            const enterButton = document.getElementById('enter-button');
            
            let coverAnimationId;

            // --- 3D COVER PAGE ANIMATION ---
            function initCoverAnimation() {
                const scene = new THREE.Scene();
                const camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 4000);
                const renderer = new THREE.WebGLRenderer({ canvas: document.getElementById('cover-canvas'), alpha: true, antialias: true });
                renderer.setSize(window.innerWidth, window.innerHeight);
                renderer.setPixelRatio(window.devicePixelRatio);
                
                const allPlanets = [];
                const allTrails = [];
                const trailLength = 100;
                
                const starGeometry = new THREE.BufferGeometry();
                const starVertices = [];
                for (let i = 0; i < 20000; i++) {
                    const x = (Math.random() - 0.5) * 3000;
                    const y = (Math.random() - 0.5) * 3000;
                    const z = (Math.random() - 0.5) * 3000;
                    starVertices.push(x, y, z);
                }
                starGeometry.setAttribute('position', new THREE.Float32BufferAttribute(starVertices, 3));
                const starMaterial = new THREE.PointsMaterial({ color: 0xffffff, size: 1.5, transparent: true, opacity: 0.9 });
                const stars = new THREE.Points(starGeometry, starMaterial);
                scene.add(stars);

                const textureLoader = new THREE.TextureLoader();
                
                function createSystem(config) {
                    const systemGroup = new THREE.Group();
                    systemGroup.position.copy(config.position);
                    scene.add(systemGroup);

                    const centralBody = config.createCentralBody(textureLoader);
                    systemGroup.add(centralBody);
                    
                    for (let i = 0; i < config.numPlanets; i++) {
                        const planetGeometry = new THREE.SphereGeometry(Math.random() * 5 + 8, 32, 32);
                        const planetMaterial = new THREE.MeshBasicMaterial({ color: config.planetColors[i % config.planetColors.length] });
                        const planet = new THREE.Mesh(planetGeometry, planetMaterial);
                        
                        planet.userData = {
                            parentSystem: systemGroup,
                            orbitRadius: (i + 1.5) * 40 + 20,
                            speed: (Math.random() * 0.005 + 0.001) * (Math.random() > 0.5 ? 1 : -1),
                            angle: Math.random() * Math.PI * 2,
                            isDragging: false
                        };
                        
                        planet.position.x = Math.cos(planet.userData.angle) * planet.userData.orbitRadius;
                        planet.position.z = Math.sin(planet.userData.angle) * planet.userData.orbitRadius;
                        
                        allPlanets.push(planet);
                        systemGroup.add(planet);

                        const trailGeometry = new THREE.BufferGeometry();
                        const trailPositions = new Float32Array(trailLength * 3);
                        trailGeometry.setAttribute('position', new THREE.BufferAttribute(trailPositions, 3));
                        const trailMaterial = new THREE.LineBasicMaterial({ color: 0xffffff, transparent: true, opacity: 0.5 });
                        const trail = new THREE.Line(trailGeometry, trailMaterial);
                        trail.userData.points = [];
                        allTrails.push({trail: trail, planet: planet});
                        scene.add(trail);
                    }
                    return { group: systemGroup, centralBody: centralBody, animateCentralBody: config.animateCentralBody };
                }

                const systems = [
                    {
                        position: new THREE.Vector3(-350, 100, -150),
                        numPlanets: 3,
                        planetColors: [0x66ccff, 0x66ff66, 0xff6666],
                        createCentralBody: () => {
                            const starGeometry = new THREE.SphereGeometry(20, 32, 32);
                            const starMaterial = new THREE.MeshBasicMaterial({ color: 0x66ccff, wireframe: true });
                            return new THREE.Mesh(starGeometry, starMaterial);
                        },
                        animateCentralBody: (body) => { body.rotation.y += 0.005; }
                    },
                    {
                        position: new THREE.Vector3(350, 50, -200),
                        numPlanets: 2,
                        planetColors: [0xffff66, 0xff66ff],
                        createCentralBody: (loader) => {
                            const group = new THREE.Group();
                            const blackHoleGeom = new THREE.SphereGeometry(15, 32, 32);
                            const blackHoleMat = new THREE.MeshBasicMaterial({ color: 0x000000 });
                            group.add(new THREE.Mesh(blackHoleGeom, blackHoleMat));
                            
                            const diskGeom = new THREE.RingGeometry(20, 40, 64);
                            const diskTexture = loader.load('https://images.unsplash.com/photo-1582241551353-a036a8747209?q=80&w=1932&auto=format&fit=crop');
                            const diskMat = new THREE.MeshBasicMaterial({ map: diskTexture, side: THREE.DoubleSide, transparent: true, opacity: 0.8 });
                            const disk = new THREE.Mesh(diskGeom, diskMat);
                            disk.rotation.x = -Math.PI / 2;
                            group.add(disk);
                            return group;
                        },
                        animateCentralBody: (body) => { 
                            const disk = body.children[1];
                            if(disk) disk.material.map.rotation += 0.002;
                        }
                    }
                ];

                const createdSystems = systems.map(s => createSystem(s));

                const ambientLight = new THREE.AmbientLight(0xffffff, 0.6);
                scene.add(ambientLight);

                camera.position.z = 400;
                camera.position.y = 150;
                camera.lookAt(new THREE.Vector3(0,0,0));

                const controls = new DragControls(allPlanets, camera, renderer.domElement);
                controls.addEventListener('dragstart', (event) => { event.object.userData.isDragging = true; });
                controls.addEventListener('dragend', (event) => {
                    event.object.userData.isDragging = false;
                    const planet = event.object;
                    const systemGroup = planet.userData.parentSystem;
                    
                    const localPos = systemGroup.worldToLocal(planet.position.clone());
                    
                    planet.userData.orbitRadius = Math.sqrt(localPos.x * localPos.x + localPos.z * localPos.z);
                    planet.userData.angle = Math.atan2(localPos.z, localPos.x);
                });
                
                const clock = new THREE.Clock();
                function animate() {
                    coverAnimationId = requestAnimationFrame(animate);
                    const time = clock.getElapsedTime();

                    createdSystems.forEach(sys => {
                        if (sys.animateCentralBody) {
                            sys.animateCentralBody(sys.centralBody, time);
                        }
                    });

                    allPlanets.forEach((planet) => {
                        if (!planet.userData.isDragging) {
                            const systemGroup = planet.userData.parentSystem;
                            planet.userData.angle += planet.userData.speed;
                            const localX = Math.cos(planet.userData.angle) * planet.userData.orbitRadius;
                            const localZ = Math.sin(planet.userData.angle) * planet.userData.orbitRadius;
                            
                            const worldPos = new THREE.Vector3(localX, 0, localZ);
                            systemGroup.localToWorld(worldPos);
                            planet.position.copy(worldPos);
                        }
                    });

                    allTrails.forEach(({trail, planet}) => {
                        const worldPos = new THREE.Vector3();
                        planet.getWorldPosition(worldPos);
                        trail.userData.points.push(worldPos);
                        if(trail.userData.points.length > trailLength) trail.userData.points.shift();
                        
                        const positions = trail.geometry.attributes.position.array;
                        trail.userData.points.forEach((p, i) => {
                            positions[i*3] = p.x;
                            positions[i*3+1] = p.y;
                            positions[i*3+2] = p.z;
                        });
                        trail.geometry.setDrawRange(0, trail.userData.points.length);
                        trail.geometry.attributes.position.needsUpdate = true;
                    });
                    
                    stars.rotation.y += 0.0001;
                    renderer.render(scene, camera);
                }
                animate();

                window.addEventListener('resize', () => {
                    camera.aspect = window.innerWidth / window.innerHeight;
                    camera.updateProjectionMatrix();
                    renderer.setSize(window.innerWidth, window.innerHeight);
                });
            }

            // --- GENERAL PAGE LOGIC ---
            setTimeout(() => { coverPage.classList.add('loaded'); }, 100);

            enterButton.addEventListener('click', () => {
                coverPage.style.opacity = '0';
                coverPage.addEventListener('transitionend', () => { 
                    coverPage.style.display = 'none'; 
                    cancelAnimationFrame(coverAnimationId);
                }, { once: true });
                mainContainer.style.display = 'flex';
                document.body.classList.add('site-entered');
                setTimeout(() => { 
                    mainContainer.style.opacity = '1'; 
                    animateContent(document.querySelector('.content-section.active'));
                }, 50);
            });

            // --- BACKGROUND & SCANNER ANIMATION (MAIN SITE) ---
            const mainStarfieldCanvas = document.getElementById('starfield');
            const mainStarfieldCtx = mainStarfieldCanvas.getContext('2d');
            const fastParticlesCanvas = document.getElementById('fast-particles');
            const fastParticlesCtx = fastParticlesCanvas.getContext('2d');
            const scanner = document.getElementById('scanner-reticle');
            const tooltip = document.getElementById('scan-tooltip');
            
            function setupCanvas(canvas) {
                canvas.width = window.innerWidth;
                canvas.height = window.innerHeight;
            }
            
            setupCanvas(mainStarfieldCanvas);
            setupCanvas(fastParticlesCanvas);

            window.addEventListener('resize', () => {
                setupCanvas(mainStarfieldCanvas);
                setupCanvas(fastParticlesCanvas);
            });

            const staticStars = Array.from({ length: 300 }, () => ({
                x: Math.random() * window.innerWidth, y: Math.random() * window.innerHeight,
                radius: Math.random() * 1.2, alpha: Math.random() * 0.7 + 0.3
            }));
            
            const fastParticles = Array.from({ length: 100 }, () => ({
                x: Math.random() * window.innerWidth, y: Math.random() * window.innerHeight,
                len: Math.random() * 20 + 10, speed: Math.random() * 5 + 2
            }));

            let mousePos = {x: 0, y: 0};
            window.addEventListener('mousemove', (e) => {
                mousePos.x = e.clientX;
                mousePos.y = e.clientY;
            });

            function animateStarfields() {
                if (mainContainer.style.display === 'flex') {
                    // Draw static stars
                    mainStarfieldCtx.clearRect(0, 0, mainStarfieldCanvas.width, mainStarfieldCanvas.height);
                    const offsetX = (mousePos.x - mainStarfieldCanvas.width / 2) / 40;
                    const offsetY = (mousePos.y - mainStarfieldCanvas.height / 2) / 40;
                    staticStars.forEach(star => {
                        const starX = star.x + offsetX;
                        const starY = star.y + offsetY;
                        mainStarfieldCtx.beginPath();
                        mainStarfieldCtx.arc(starX, starY, star.radius, 0, Math.PI * 2);
                        mainStarfieldCtx.fillStyle = `rgba(224, 224, 224, ${star.alpha})`;
                        mainStarfieldCtx.fill();
                    });

                    // Draw fast particles
                    fastParticlesCtx.clearRect(0, 0, fastParticlesCanvas.width, fastParticlesCanvas.height);
                    fastParticlesCtx.strokeStyle = 'rgba(255, 255, 255, 0.5)';
                    fastParticles.forEach(p => {
                        p.x -= p.speed;
                        if(p.x < 0) { p.x = fastParticlesCanvas.width; p.y = Math.random() * fastParticlesCanvas.height; }
                        fastParticlesCtx.beginPath();
                        fastParticlesCtx.moveTo(p.x, p.y);
                        fastParticlesCtx.lineTo(p.x + p.len, p.y);
                        fastParticlesCtx.stroke();
                    });
                    
                    // Update scanner position
                    scanner.style.left = `${mousePos.x}px`;
                    scanner.style.top = `${mousePos.y}px`;
                }
                requestAnimationFrame(animateStarfields);
            }
            
            initCoverAnimation();
            animateStarfields();
            
            // --- SCANNER LOGIC ---
            document.querySelectorAll('.scannable').forEach(el => {
                el.addEventListener('mouseenter', e => {
                    tooltip.textContent = e.target.dataset.scanInfo;
                    tooltip.style.opacity = '1';
                });
                el.addEventListener('mousemove', e => {
                    tooltip.style.left = `${e.clientX + 25}px`;
                    tooltip.style.top = `${e.clientY + 25}px`;
                });
                el.addEventListener('mouseleave', () => {
                    tooltip.style.opacity = '0';
                });
            });

            // --- NAVIGATION AND CONTENT ANIMATION SCRIPT ---
            const navLinks = document.querySelectorAll('.nav-link');
            const contentSections = document.querySelectorAll('.content-section');
            const researchCards = document.querySelectorAll('.research-card');

            function animateContent(section) {
                const itemsToAnimate = section.querySelectorAll('p, li, h4, .research-card');
                itemsToAnimate.forEach((item, index) => {
                    item.style.animation = 'none';
                    void item.offsetWidth;
                    if(item.tagName === 'H4') {
                         item.style.animation = `glitch 1s linear forwards ${index * 0.05}s`;
                    } else {
                        item.style.animation = `fade-in-up 0.5s ease-out forwards ${index * 0.05}s`;
                    }
                });
            }

            navLinks.forEach(link => {
                link.addEventListener('click', (e) => {
                    e.preventDefault();
                    const targetId = link.getAttribute('href').substring(1);
                    const targetSection = document.getElementById(targetId);
                    if (targetSection.classList.contains('active')) return;
                    navLinks.forEach(navLink => navLink.classList.remove('active'));
                    link.classList.add('active');
                    contentSections.forEach(section => section.classList.remove('active'));
                    targetSection.classList.add('active');
                    animateContent(targetSection);
                });
            });
            
            researchCards.forEach(card => {
                card.addEventListener('click', () => {
                    if (!card.classList.contains('active')) {
                        researchCards.forEach(c => c.classList.remove('active'));
                    }
                    card.classList.toggle('active');
                });
            });
        });
    </script>
</body>
</html>
